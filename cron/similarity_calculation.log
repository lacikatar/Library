Starting similarity calculation at 2025-05-23 12:21:55
Database connection successful
SIMILARITY function exists
SIMILARITY function test result: 1
Executing query: 
            SELECT b.ISBN, b.Title, b.Description, b.Series_ID,
                   GROUP_CONCAT(DISTINCT c.Name) AS Categories,
                   GROUP_CONCAT(DISTINCT t.Tag_Name) AS Tags,
                   GROUP_CONCAT(DISTINCT a.Name) AS Authors
            FROM book b
            LEFT JOIN belongs bc ON b.ISBN = bc.ISBN
            LEFT JOIN category c ON bc.Category_ID = c.Category_ID
            LEFT JOIN book_tags bt ON b.ISBN = bt.ISBN
            LEFT JOIN tags t ON bt.Tag_ID = t.Tag_ID
            LEFT JOIN wrote w ON b.ISBN = w.ISBN
            LEFT JOIN author a ON w.Author_ID = a.Author_ID
            LEFT JOIN (
                SELECT ISBN_1, COUNT(*) AS sim_count
                FROM book_similarity
                GROUP BY ISBN_1
            ) bs ON b.ISBN = bs.ISBN_1
            WHERE bs.sim_count IS NULL OR bs.sim_count < 10
            GROUP BY b.ISBN
            LIMIT 100 OFFSET 0
        
Retrieved 100 books in this batch
Processing book: The Last Battle (ISBN: 9780007202324)
Executing similarity query for ISBN: 9780007202324
Found 8 similar books
Adding similarity: 9780007202324 -> 9780064471091 (score: 0.657143)
Adding similarity: 9780007202324 -> 9780007202300 (score: 0.557143)
Adding similarity: 9780007202324 -> 9780060234812 (score: 0.557143)
Adding similarity: 9780007202324 -> 9780060764906 (score: 0.557143)
Adding similarity: 9780007202324 -> 9780061125270 (score: 0.557143)
Adding similarity: 9780007202324 -> 9780439861366 (score: 0.557143)
Adding similarity: 9780007202324 -> 9780152023980 (score: 0.214286)
Adding similarity: 9780007202324 -> 9780435123987 (score: 0.214286)
Processing book: The Burning God (ISBN: 9780008339142)
Executing similarity query for ISBN: 9780008339142
Found 1 similar books
Adding similarity: 9780008339142 -> 9780008532772 (score: 0.385714)
Processing book: Yellowface (ISBN: 9780008532772)
Executing similarity query for ISBN: 9780008532772
Found 5 similar books
Adding similarity: 9780008532772 -> 9780008339142 (score: 0.385714)
Adding similarity: 9780008532772 -> 9780062662590 (score: 0.385714)
Adding similarity: 9780008532772 -> 9780062662637 (score: 0.385714)
Adding similarity: 9780008532772 -> 9780593492918 (score: 0.250000)
Adding similarity: 9780008532772 -> 9780593374207 (score: 0.214286)
Processing book: To Kill a Mockingbird (ISBN: 9780061120084)
Executing similarity query for ISBN: 9780061120084
Found 0 similar books
Processing book: The Murder of Roger Ackroyd (ISBN: 9780062073501)
Executing similarity query for ISBN: 9780062073501
Found 0 similar books
Processing book: Murder on the Orient Express (ISBN: 9780062073563)
Executing similarity query for ISBN: 9780062073563
Found 0 similar books
Processing book: Go Set a Watchman (ISBN: 9780062409850)
Executing similarity query for ISBN: 9780062409850
Found 0 similar books
Processing book: The Poppy War (ISBN: 9780062662590)
Executing similarity query for ISBN: 9780062662590
Found 1 similar books
Adding similarity: 9780062662590 -> 9780008532772 (score: 0.385714)
Processing book: The Dragon Republic (ISBN: 9780062662637)
Executing similarity query for ISBN: 9780062662637
Found 1 similar books
Adding similarity: 9780062662637 -> 9780008532772 (score: 0.385714)
Processing book: War and Peace (ISBN: 9780140447934)
Executing similarity query for ISBN: 9780140447934
Found 0 similar books
Processing book: Anna Karenina (ISBN: 9780140449174)
Executing similarity query for ISBN: 9780140449174
Found 0 similar books
Processing book: The Picture of Dorian Gray (ISBN: 9780141439570)
Executing similarity query for ISBN: 9780141439570
Found 2 similar books
Adding similarity: 9780141439570 -> 9781250095282 (score: 0.350000)
Adding similarity: 9780141439570 -> 9780393970128 (score: 0.250000)
Processing book: The Outsiders (ISBN: 9780142407332)
Executing similarity query for ISBN: 9780142407332
Found 3 similar books
Adding similarity: 9780142407332 -> 9780998809106 (score: 0.330000)
Adding similarity: 9780142407332 -> 9780743477116 (score: 0.280000)
Adding similarity: 9780142407332 -> 9780743273565 (score: 0.250000)
Processing book: Adventures of Huckleberry Finn (ISBN: 9780142437178)
Executing similarity query for ISBN: 9780142437178
Found 0 similar books
Processing book: The Adventures of Tom Sawyer (ISBN: 9780142437179)
Executing similarity query for ISBN: 9780142437179
Found 0 similar books
Processing book: The Little Prince (ISBN: 9780152023980)
Executing similarity query for ISBN: 9780152023980
Found 4 similar books
Adding similarity: 9780152023980 -> 9780007202300 (score: 0.250000)
Adding similarity: 9780152023980 -> 9780060234812 (score: 0.250000)
Adding similarity: 9780152023980 -> 9780435123987 (score: 0.250000)
Adding similarity: 9780152023980 -> 9780007202324 (score: 0.214286)
Processing book: The Last Man (ISBN: 9780199537150)
Executing similarity query for ISBN: 9780199537150
Found 0 similar books
Processing book: The Odyssey (ISBN: 9780226604428)
Executing similarity query for ISBN: 9780226604428
Found 0 similar books
Processing book: The Two Towers (ISBN: 9780261102361)
Executing similarity query for ISBN: 9780261102361
Found 0 similar books
Processing book: The Return of the King (ISBN: 9780261103252)
Executing similarity query for ISBN: 9780261103252
Found 0 similar books
Processing book: The Fellowship of the Ring (ISBN: 9780261103573)
Executing similarity query for ISBN: 9780261103573
Found 0 similar books
Processing book: The Nightingale (ISBN: 9780312577223)
Executing similarity query for ISBN: 9780312577223
Found 2 similar books
Adding similarity: 9780312577223 -> 9780771005459 (score: 0.250000)
Adding similarity: 9780312577223 -> 9781682815663 (score: 0.250000)
Processing book: Twilight (ISBN: 9780316327336)
Executing similarity query for ISBN: 9780316327336
Found 0 similar books
Processing book: New Moon (ISBN: 9780316327787)
Executing similarity query for ISBN: 9780316327787
Found 0 similar books
Processing book: Eclipse (ISBN: 9780316328142)
Executing similarity query for ISBN: 9780316328142
Found 0 similar books
Processing book: Breaking Dawn (ISBN: 9780316328326)
Executing similarity query for ISBN: 9780316328326
Found 0 similar books
Processing book: Jade War (ISBN: 9780316440929)
Executing similarity query for ISBN: 9780316440929
Found 9 similar books
Adding similarity: 9780316440929 -> 9780356510590 (score: 1.000000)
Adding similarity: 9780316440929 -> 9780316440882 (score: 0.750000)
Adding similarity: 9780316440929 -> 9780593156599 (score: 0.250000)
Adding similarity: 9780316440929 -> 9781416914280 (score: 0.250000)
Adding similarity: 9780316440929 -> 9781416914297 (score: 0.250000)
Adding similarity: 9780316440929 -> 9781416914303 (score: 0.250000)
Adding similarity: 9780316440929 -> 9781442403543 (score: 0.250000)
Adding similarity: 9780316440929 -> 9781442416864 (score: 0.250000)
Adding similarity: 9780316440929 -> 9781481426305 (score: 0.250000)
Processing book: Revenge of the Tipping Point (ISBN: 9780316575805)
Executing similarity query for ISBN: 9780316575805
Found 0 similar books
Processing book: Midnight Sun (ISBN: 9780316629454)
Executing similarity query for ISBN: 9780316629454
Found 0 similar books
Processing book: Jade Legacy (ISBN: 9780356510590)
Executing similarity query for ISBN: 9780356510590
Found 9 similar books
Adding similarity: 9780356510590 -> 9780316440929 (score: 1.000000)
Adding similarity: 9780356510590 -> 9780316440882 (score: 0.750000)
Adding similarity: 9780356510590 -> 9780593156599 (score: 0.250000)
Adding similarity: 9780356510590 -> 9781416914280 (score: 0.250000)
Adding similarity: 9780356510590 -> 9781416914297 (score: 0.250000)
Adding similarity: 9780356510590 -> 9781416914303 (score: 0.250000)
Adding similarity: 9780356510590 -> 9781442403543 (score: 0.250000)
Adding similarity: 9780356510590 -> 9781442416864 (score: 0.250000)
Adding similarity: 9780356510590 -> 9781481426305 (score: 0.250000)
Processing book: Four Thousand Weeks (ISBN: 9780374159122)
Executing similarity query for ISBN: 9780374159122
Found 5 similar books
Adding similarity: 9780374159122 -> 9781949759624 (score: 0.500000)
Adding similarity: 9780374159122 -> 9780593230084 (score: 0.350000)
Adding similarity: 9780374159122 -> 9780593653142 (score: 0.350000)
Adding similarity: 9780374159122 -> 9789355433596 (score: 0.350000)
Adding similarity: 9780374159122 -> 9781401971373 (score: 0.300000)
Processing book: The Brothers Karamazov (ISBN: 9780374528379)
Executing similarity query for ISBN: 9780374528379
Found 0 similar books
Processing book: Intermezzo (ISBN: 9780374602635)
Executing similarity query for ISBN: 9780374602635
Found 5 similar books
Adding similarity: 9780374602635 -> 9781402277825 (score: 0.240000)
Adding similarity: 9780374602635 -> 9781405955317 (score: 0.240000)
Adding similarity: 9780374602635 -> 9781405962971 (score: 0.240000)
Adding similarity: 9780374602635 -> 9781728274867 (score: 0.240000)
Adding similarity: 9780374602635 -> 9781728276229 (score: 0.240000)
Processing book: Norwegian Wood (ISBN: 9780375704024)
Executing similarity query for ISBN: 9780375704024
Found 0 similar books
Processing book: The Book Thief (ISBN: 9780375842207)
Executing similarity query for ISBN: 9780375842207
Found 0 similar books
Processing book: Dracula (ISBN: 9780393970128)
Executing similarity query for ISBN: 9780393970128
Found 8 similar books
Adding similarity: 9780393970128 -> 9781416914280 (score: 0.300000)
Adding similarity: 9780393970128 -> 9781416914297 (score: 0.300000)
Adding similarity: 9780393970128 -> 9781416914303 (score: 0.300000)
Adding similarity: 9780393970128 -> 9781442403543 (score: 0.300000)
Adding similarity: 9780393970128 -> 9781442416864 (score: 0.300000)
Adding similarity: 9780393970128 -> 9781481426305 (score: 0.300000)
Adding similarity: 9780393970128 -> 9780141439570 (score: 0.250000)
Adding similarity: 9780393970128 -> 9781952457258 (score: 0.250000)
Processing book: The Hunger Games (ISBN: 9780439023481)
Executing similarity query for ISBN: 9780439023481
Found 0 similar books
Processing book: Catching Fire (ISBN: 9780439023498)
Executing similarity query for ISBN: 9780439023498
Found 0 similar books
Processing book: Mockingjay (ISBN: 9780439023511)
Executing similarity query for ISBN: 9780439023511
Found 0 similar books
Processing book: The Shining (ISBN: 9780450411434)
Executing similarity query for ISBN: 9780450411434
Found 0 similar books
Processing book: The Hound of the Baskervilles (ISBN: 9780451527998)
Executing similarity query for ISBN: 9780451527998
Found 0 similar books
Processing book: A Study in Scarlet (ISBN: 9780451528018)
Executing similarity query for ISBN: 9780451528018
Found 0 similar books
Processing book: Frankenstein (ISBN: 9780486282114)
Executing similarity query for ISBN: 9780486282114
Found 0 similar books
Processing book: Mexican Gothic (ISBN: 9780525620785)
Executing similarity query for ISBN: 9780525620785
Found 0 similar books
Processing book: A Storm of Swords (ISBN: 9780553106633)
Executing similarity query for ISBN: 9780553106633
Found 0 similar books
Processing book: Foundation (ISBN: 9780553293357)
Executing similarity query for ISBN: 9780553293357
Found 0 similar books
Processing book: Foundation and Empire (ISBN: 9780553293371)
Executing similarity query for ISBN: 9780553293371
Found 0 similar books
Processing book: Second Foundation (ISBN: 9780553293388)
Executing similarity query for ISBN: 9780553293388
Found 0 similar books
Processing book: The Diary of a Young Girl (ISBN: 9780553296983)
Executing similarity query for ISBN: 9780553296983
Found 0 similar books
Processing book: A Game of Thrones (ISBN: 9780553573404)
Executing similarity query for ISBN: 9780553573404
Found 0 similar books
Processing book: A Clash of Kings (ISBN: 9780553579901)
Executing similarity query for ISBN: 9780553579901
Found 0 similar books
Processing book: A Feast for Crows (ISBN: 9780553582024)
Executing similarity query for ISBN: 9780553582024
Found 0 similar books
Processing book: A Dance with Dragons (ISBN: 9780553801477)
Executing similarity query for ISBN: 9780553801477
Found 0 similar books
Processing book: Children of Dune (ISBN: 9780593098240)
Executing similarity query for ISBN: 9780593098240
Found 8 similar books
Adding similarity: 9780593098240 -> 9780593098257 (score: 0.940000)
Adding similarity: 9780593098240 -> 9780593098264 (score: 0.940000)
Adding similarity: 9780593098240 -> 9780593098271 (score: 0.940000)
Adding similarity: 9780593098240 -> 9780593098233 (score: 0.790000)
Adding similarity: 9780593098240 -> 9780593099322 (score: 0.750000)
Adding similarity: 9780593098240 -> 9780765312921 (score: 0.640000)
Adding similarity: 9780593098240 -> 9780765312938 (score: 0.640000)
Adding similarity: 9780593098240 -> 9780316440882 (score: 0.240000)
Processing book: Dune (ISBN: 9780593099322)
Executing similarity query for ISBN: 9780593099322
Found 7 similar books
Adding similarity: 9780593099322 -> 9780593098240 (score: 0.750000)
Adding similarity: 9780593099322 -> 9780593098257 (score: 0.750000)
Adding similarity: 9780593099322 -> 9780593098264 (score: 0.750000)
Adding similarity: 9780593099322 -> 9780593098271 (score: 0.750000)
Adding similarity: 9780593099322 -> 9780593098233 (score: 0.600000)
Adding similarity: 9780593099322 -> 9780765312921 (score: 0.450000)
Adding similarity: 9780593099322 -> 9780765312938 (score: 0.450000)
Processing book: How to Know a Person (ISBN: 9780593230084)
Executing similarity query for ISBN: 9780593230084
Found 5 similar books
Adding similarity: 9780593230084 -> 9780593653142 (score: 0.390000)
Adding similarity: 9780593230084 -> 9789355433596 (score: 0.390000)
Adding similarity: 9780593230084 -> 9780374159122 (score: 0.350000)
Adding similarity: 9780593230084 -> 9781949759624 (score: 0.350000)
Adding similarity: 9780593230084 -> 9781401971373 (score: 0.340000)
Processing book: The Hill We Climb (ISBN: 9780593465271)
Executing similarity query for ISBN: 9780593465271
Found 0 similar books
Processing book: Hidden Potential (ISBN: 9780593653142)
Executing similarity query for ISBN: 9780593653142
Found 5 similar books
Adding similarity: 9780593653142 -> 9780593230084 (score: 0.390000)
Adding similarity: 9780593653142 -> 9789355433596 (score: 0.390000)
Adding similarity: 9780593653142 -> 9780374159122 (score: 0.350000)
Adding similarity: 9780593653142 -> 9781949759624 (score: 0.350000)
Adding similarity: 9780593653142 -> 9781401971373 (score: 0.340000)
Processing book: Source Code (ISBN: 9780593801581)
Executing similarity query for ISBN: 9780593801581
Found 3 similar books
Adding similarity: 9780593801581 -> 9780063037328 (score: 0.214286)
Adding similarity: 9780593801581 -> 9781250866448 (score: 0.214286)
Adding similarity: 9780593801581 -> 9781524763138 (score: 0.214286)
Processing book: Crime and Punishment (ISBN: 9780679734505)
Executing similarity query for ISBN: 9780679734505
Found 0 similar books
Processing book: Pride and Prejudice (ISBN: 9780679783268)
Executing similarity query for ISBN: 9780679783268
Found 0 similar books
Processing book: Sense and Sensibility (ISBN: 9780679783275)
Executing similarity query for ISBN: 9780679783275
Found 0 similar books
Processing book: A Farewell to Arms (ISBN: 9780684801469)
Executing similarity query for ISBN: 9780684801469
Found 0 similar books
Processing book: The Old Man and the Sea (ISBN: 9780684830490)
Executing similarity query for ISBN: 9780684830490
Found 0 similar books
Processing book: The Great Gatsby (ISBN: 9780743273565)
Executing similarity query for ISBN: 9780743273565
Found 3 similar books
Adding similarity: 9780743273565 -> 9780998809106 (score: 0.300000)
Adding similarity: 9780743273565 -> 9780142407332 (score: 0.250000)
Adding similarity: 9780743273565 -> 9780743477116 (score: 0.250000)
Processing book: Romeo and Juliet (ISBN: 9780743477116)
Executing similarity query for ISBN: 9780743477116
Found 3 similar books
Adding similarity: 9780743477116 -> 9780998809106 (score: 0.740000)
Adding similarity: 9780743477116 -> 9780142407332 (score: 0.280000)
Adding similarity: 9780743477116 -> 9780743273565 (score: 0.250000)
Processing book: Harry Potter and the Sorcerer's Stone (ISBN: 9780747532743)
Executing similarity query for ISBN: 9780747532743
Found 0 similar books
Processing book: Harry Potter and the Chamber of Secrets (ISBN: 9780747538493)
Executing similarity query for ISBN: 9780747538493
Found 0 similar books
Processing book: Harry Potter and the Prisoner of Azkaban (ISBN: 9780747542155)
Executing similarity query for ISBN: 9780747542155
Found 0 similar books
Processing book: Harry Potter and the Goblet of Fire (ISBN: 9780747546245)
Executing similarity query for ISBN: 9780747546245
Found 0 similar books
Processing book: Harry Potter and the Order of the Phoenix (ISBN: 9780747551003)
Executing similarity query for ISBN: 9780747551003
Found 0 similar books
Processing book: Harry Potter and the Half-Blood Prince (ISBN: 9780747581109)
Executing similarity query for ISBN: 9780747581109
Found 0 similar books
Processing book: Harry Potter and the Deathly Hallows (ISBN: 9780747591054)
Executing similarity query for ISBN: 9780747591054
Found 0 similar books
Processing book: Held (ISBN: 9780771005459)
Executing similarity query for ISBN: 9780771005459
Found 1 similar books
Adding similarity: 9780771005459 -> 9780312577223 (score: 0.250000)
Processing book: Macbeth (ISBN: 9780998809106)
Executing similarity query for ISBN: 9780998809106
Found 3 similar books
Adding similarity: 9780998809106 -> 9780743477116 (score: 0.740000)
Adding similarity: 9780998809106 -> 9780142407332 (score: 0.330000)
Adding similarity: 9780998809106 -> 9780743273565 (score: 0.300000)
Processing book: If We Were Villains (ISBN: 9781250095282)
Executing similarity query for ISBN: 9781250095282
Found 4 similar books
Adding similarity: 9781250095282 -> 9780141439570 (score: 0.350000)
Adding similarity: 9781250095282 -> 9781250304452 (score: 0.350000)
Adding similarity: 9781250095282 -> 9780593492918 (score: 0.250000)
Adding similarity: 9781250095282 -> 9780593374207 (score: 0.214286)
Processing book: Friends, Lovers, and the Big Terrible Thing (ISBN: 9781250866448)
Executing similarity query for ISBN: 9781250866448
Found 9 similar books
Adding similarity: 9781250866448 -> 9780063037328 (score: 0.450000)
Adding similarity: 9781250866448 -> 9789355433596 (score: 0.270000)
Adding similarity: 9781250866448 -> 9781524763138 (score: 0.250000)
Adding similarity: 9781250866448 -> 9781401971373 (score: 0.220000)
Adding similarity: 9781250866448 -> 9780593801581 (score: 0.214286)
Adding similarity: 9781250866448 -> 9780525708087 (score: 0.210000)
Adding similarity: 9781250866448 -> 9781402277825 (score: 0.210000)
Adding similarity: 9781250866448 -> 9781405962971 (score: 0.210000)
Adding similarity: 9781250866448 -> 9781728276229 (score: 0.210000)
Processing book: The Ballad of Songbirds and Snakes (ISBN: 9781338635171)
Executing similarity query for ISBN: 9781338635171
Found 0 similar books
Processing book: The Let Them Theory (ISBN: 9781401971373)
Executing similarity query for ISBN: 9781401971373
Found 7 similar books
Adding similarity: 9781401971373 -> 9789355433596 (score: 0.440000)
Adding similarity: 9781401971373 -> 9780593230084 (score: 0.340000)
Adding similarity: 9781401971373 -> 9780593653142 (score: 0.340000)
Adding similarity: 9781401971373 -> 9780374159122 (score: 0.300000)
Adding similarity: 9781401971373 -> 9781949759624 (score: 0.300000)
Adding similarity: 9781401971373 -> 9780063037328 (score: 0.220000)
Adding similarity: 9781401971373 -> 9781250866448 (score: 0.220000)
Processing book: A Good Girl's Guide to Murder (ISBN: 9781405293181)
Executing similarity query for ISBN: 9781405293181
Found 5 similar books
Adding similarity: 9781405293181 -> 9780593356159 (score: 0.214286)
Adding similarity: 9781405293181 -> 9780593356180 (score: 0.214286)
Adding similarity: 9781405293181 -> 9780593474013 (score: 0.214286)
Adding similarity: 9781405293181 -> 9780593492918 (score: 0.214286)
Adding similarity: 9781405293181 -> 9781662506499 (score: 0.214286)
Processing book: The Naturals (ISBN: 9781423168232)
Executing similarity query for ISBN: 9781423168232
Found 6 similar books
Adding similarity: 9781423168232 -> 9780593356159 (score: 0.214286)
Adding similarity: 9781423168232 -> 9780593356180 (score: 0.214286)
Adding similarity: 9781423168232 -> 9780593474013 (score: 0.214286)
Adding similarity: 9781423168232 -> 9781250301697 (score: 0.214286)
Adding similarity: 9781423168232 -> 9781538724743 (score: 0.214286)
Adding similarity: 9781423168232 -> 9781662506499 (score: 0.214286)
Processing book: Killer Instinct (ISBN: 9781423168324)
Executing similarity query for ISBN: 9781423168324
Found 6 similar books
Adding similarity: 9781423168324 -> 9780593356159 (score: 0.214286)
Adding similarity: 9781423168324 -> 9780593356180 (score: 0.214286)
Adding similarity: 9781423168324 -> 9780593474013 (score: 0.214286)
Adding similarity: 9781423168324 -> 9781250301697 (score: 0.214286)
Adding similarity: 9781423168324 -> 9781538724743 (score: 0.214286)
Adding similarity: 9781423168324 -> 9781662506499 (score: 0.214286)
Processing book: All In (ISBN: 9781484716434)
Executing similarity query for ISBN: 9781484716434
Found 6 similar books
Adding similarity: 9781484716434 -> 9780593356159 (score: 0.214286)
Adding similarity: 9781484716434 -> 9780593356180 (score: 0.214286)
Adding similarity: 9781484716434 -> 9780593474013 (score: 0.214286)
Adding similarity: 9781484716434 -> 9781250301697 (score: 0.214286)
Adding similarity: 9781484716434 -> 9781538724743 (score: 0.214286)
Adding similarity: 9781484716434 -> 9781662506499 (score: 0.214286)
Processing book: Bad Blood (ISBN: 9781484757321)
Executing similarity query for ISBN: 9781484757321
Found 6 similar books
Adding similarity: 9781484757321 -> 9780593356159 (score: 0.214286)
Adding similarity: 9781484757321 -> 9780593356180 (score: 0.214286)
Adding similarity: 9781484757321 -> 9780593474013 (score: 0.214286)
Adding similarity: 9781484757321 -> 9781250301697 (score: 0.214286)
Adding similarity: 9781484757321 -> 9781538724743 (score: 0.214286)
Adding similarity: 9781484757321 -> 9781662506499 (score: 0.214286)
Processing book: It (ISBN: 9781501142970)
Executing similarity query for ISBN: 9781501142970
Found 0 similar books
Processing book: Becoming (ISBN: 9781524763138)
Executing similarity query for ISBN: 9781524763138
Found 7 similar books
Adding similarity: 9781524763138 -> 9780063037328 (score: 0.400000)
Adding similarity: 9781524763138 -> 9780316556347 (score: 0.350000)
Adding similarity: 9781524763138 -> 9780593356159 (score: 0.350000)
Adding similarity: 9781524763138 -> 9780735219113 (score: 0.350000)
Adding similarity: 9781524763138 -> 9781682815663 (score: 0.350000)
Adding similarity: 9781524763138 -> 9781250866448 (score: 0.250000)
Adding similarity: 9781524763138 -> 9780593801581 (score: 0.214286)
Processing book: Foul Lady Fortune (ISBN: 9781529380262)
Executing similarity query for ISBN: 9781529380262
Found 3 similar books
Adding similarity: 9781529380262 -> 9781529344561 (score: 0.614286)
Adding similarity: 9781529380262 -> 9781534457690 (score: 0.571429)
Adding similarity: 9781529380262 -> 9781250095251 (score: 0.214286)
Processing book: Foul Heart Huntsman (ISBN: 9781665905619)
Executing similarity query for ISBN: 9781665905619
Found 3 similar books
Adding similarity: 9781665905619 -> 9781529344561 (score: 0.614286)
Adding similarity: 9781665905619 -> 9781534457690 (score: 0.571429)
Adding similarity: 9781665905619 -> 9781250095251 (score: 0.214286)
Processing book: Twisted Lies (ISBN: 9781728274898)
Executing similarity query for ISBN: 9781728274898
Found 9 similar books
Adding similarity: 9781728274898 -> 9781728274874 (score: 0.825000)
Adding similarity: 9781728274898 -> 9781728274867 (score: 0.730000)
Adding similarity: 9781728274898 -> 9781728274881 (score: 0.700000)
Adding similarity: 9781728274898 -> 9781093765007 (score: 0.320000)
Adding similarity: 9781728274898 -> 9781721284443 (score: 0.320000)
Adding similarity: 9781728274898 -> 9798580938387 (score: 0.320000)
Adding similarity: 9781728274898 -> 9781405955317 (score: 0.255000)
Adding similarity: 9781728274898 -> 9781405962971 (score: 0.255000)
Adding similarity: 9781728274898 -> 9781957635156 (score: 0.225000)
Processing book: Sunrise on The Reaping (ISBN: 9781761641176)
Executing similarity query for ISBN: 9781761641176
Found 0 similar books
Processing book: The Testaments (ISBN: 9781784742324)
Executing similarity query for ISBN: 9781784742324
Found 10 similar books
Adding similarity: 9781784742324 -> 9781328879943 (score: 0.925000)
Adding similarity: 9781784742324 -> 9780062085504 (score: 0.280000)
Adding similarity: 9781784742324 -> 9780062310637 (score: 0.250000)
Adding similarity: 9781784742324 -> 9780062310668 (score: 0.250000)
Adding similarity: 9781784742324 -> 9780451524935 (score: 0.250000)
Adding similarity: 9781784742324 -> 9781368023245 (score: 0.250000)
Adding similarity: 9781784742324 -> 9780593098233 (score: 0.240000)
Adding similarity: 9781784742324 -> 9780593098257 (score: 0.240000)
Adding similarity: 9781784742324 -> 9780593098264 (score: 0.240000)
Adding similarity: 9781784742324 -> 9780593098271 (score: 0.240000)
Processing book: The Housemaid (ISBN: 9781803144375)
Executing similarity query for ISBN: 9781803144375
Found 10 similar books
Adding similarity: 9781803144375 -> 9781464223310 (score: 1.000000)
Adding similarity: 9781803144375 -> 9781837901319 (score: 1.000000)
Adding similarity: 9781803144375 -> 9781464228599 (score: 0.900000)
Adding similarity: 9781803144375 -> 9781728296227 (score: 0.700000)
Adding similarity: 9781803144375 -> 9780008297190 (score: 0.600000)
Adding similarity: 9781803144375 -> 9780593492918 (score: 0.550000)
Adding similarity: 9781803144375 -> 9781250895783 (score: 0.550000)
Adding similarity: 9781803144375 -> 9781662506499 (score: 0.550000)
Adding similarity: 9781803144375 -> 9780008297169 (score: 0.400000)
Adding similarity: 9781803144375 -> 9781250266101 (score: 0.400000)
Processing book: The Housemaid's Secret (ISBN: 9781837901319)
Executing similarity query for ISBN: 9781837901319
Found 10 similar books
Adding similarity: 9781837901319 -> 9781464223310 (score: 1.000000)
Adding similarity: 9781837901319 -> 9781803144375 (score: 1.000000)
Adding similarity: 9781837901319 -> 9781464228599 (score: 0.900000)
Adding similarity: 9781837901319 -> 9781728296227 (score: 0.700000)
Adding similarity: 9781837901319 -> 9780008297190 (score: 0.600000)
Adding similarity: 9781837901319 -> 9780593492918 (score: 0.550000)
Adding similarity: 9781837901319 -> 9781250895783 (score: 0.550000)
Adding similarity: 9781837901319 -> 9781662506499 (score: 0.550000)
Adding similarity: 9781837901319 -> 9780008297169 (score: 0.400000)
Adding similarity: 9781837901319 -> 9781250266101 (score: 0.400000)
Processing book: Principles of Economics (ISBN: 9781936126163)
Executing similarity query for ISBN: 9781936126163
Found 0 similar books
Processing book: Top Secret (ISBN: 9781942444800)
Executing similarity query for ISBN: 9781942444800
Found 10 similar books
Adding similarity: 9781942444800 -> 9781954500495 (score: 0.625000)
Adding similarity: 9781942444800 -> 9781954500501 (score: 0.625000)
Adding similarity: 9781942444800 -> 9781728274881 (score: 0.325000)
Adding similarity: 9781942444800 -> 9781464237218 (score: 0.300000)
Adding similarity: 9781942444800 -> 9781464237263 (score: 0.300000)
Adding similarity: 9781942444800 -> 9781464237324 (score: 0.300000)
Adding similarity: 9781942444800 -> 9781464237409 (score: 0.300000)
Adding similarity: 9781942444800 -> 9781464237416 (score: 0.300000)
Adding similarity: 9781942444800 -> 9781464238864 (score: 0.300000)
Adding similarity: 9781942444800 -> 9781250316776 (score: 0.280000)
Processing book: The Pivot Year (ISBN: 9781949759624)
Executing similarity query for ISBN: 9781949759624
Found 5 similar books
Adding similarity: 9781949759624 -> 9789355433596 (score: 0.700000)
Adding similarity: 9781949759624 -> 9780374159122 (score: 0.500000)
Adding similarity: 9781949759624 -> 9780593230084 (score: 0.350000)
Adding similarity: 9781949759624 -> 9780593653142 (score: 0.350000)
Adding similarity: 9781949759624 -> 9781401971373 (score: 0.300000)
Processing book: From Blood and Ash (ISBN: 9781952457012)
Executing similarity query for ISBN: 9781952457012
Found 10 similar books
Adding similarity: 9781952457012 -> 9781952457104 (score: 0.925000)
Adding similarity: 9781952457012 -> 9781952457722 (score: 0.840000)
Adding similarity: 9781952457012 -> 9781952457258 (score: 0.840000)
Adding similarity: 9781952457012 -> 9781529350500 (score: 0.350000)
Adding similarity: 9781952457012 -> 9781649374172 (score: 0.325000)
Adding similarity: 9781952457012 -> 9781398529489 (score: 0.320000)
Adding similarity: 9781952457012 -> 9781250268426 (score: 0.320000)
Adding similarity: 9781952457012 -> 9781665955430 (score: 0.320000)
Adding similarity: 9781952457012 -> 9781649374042 (score: 0.300000)
Adding similarity: 9781952457012 -> 9780316310338 (score: 0.280000)
Processing book: A Kingdom of Flesh and Fire (ISBN: 9781952457104)
Executing similarity query for ISBN: 9781952457104
Found 10 similar books
Adding similarity: 9781952457104 -> 9781952457012 (score: 0.925000)
Adding similarity: 9781952457104 -> 9781952457258 (score: 0.840000)
Adding similarity: 9781952457104 -> 9781952457722 (score: 0.780000)
Adding similarity: 9781952457104 -> 9781250268426 (score: 0.380000)
Adding similarity: 9781952457104 -> 9781529350500 (score: 0.350000)
Adding similarity: 9781952457104 -> 9781649374172 (score: 0.325000)
Adding similarity: 9781952457104 -> 9781649374189 (score: 0.325000)
Adding similarity: 9781952457104 -> 9781398529489 (score: 0.320000)
Adding similarity: 9781952457104 -> 9781665955430 (score: 0.320000)
Adding similarity: 9781952457104 -> 9781649374042 (score: 0.300000)
Processing book: The ​Crown of Gilded Bones (ISBN: 9781952457258)
Executing similarity query for ISBN: 9781952457258
Found 10 similar books
Adding similarity: 9781952457258 -> 9781952457722 (score: 0.940000)
Adding similarity: 9781952457258 -> 9781952457012 (score: 0.840000)
Adding similarity: 9781952457258 -> 9781952457104 (score: 0.840000)
Adding similarity: 9781952457258 -> 9781250268396 (score: 0.390000)
Adding similarity: 9781952457258 -> 9781665955461 (score: 0.390000)
Adding similarity: 9781952457258 -> 9780316312486 (score: 0.350000)
Adding similarity: 9781952457258 -> 9780316342087 (score: 0.330000)
Adding similarity: 9781952457258 -> 9781250268426 (score: 0.330000)
Adding similarity: 9781952457258 -> 9781250851208 (score: 0.330000)
Adding similarity: 9781952457258 -> 9781398529489 (score: 0.330000)
Processing book: The War of Two Queens (ISBN: 9781952457722)
Executing similarity query for ISBN: 9781952457722
Found 10 similar books
Adding similarity: 9781952457722 -> 9781952457258 (score: 0.940000)
Adding similarity: 9781952457722 -> 9781952457012 (score: 0.840000)
Adding similarity: 9781952457722 -> 9781952457104 (score: 0.780000)
Adding similarity: 9781952457722 -> 9781649374172 (score: 0.340000)
Adding similarity: 9781952457722 -> 9780316342087 (score: 0.330000)
Adding similarity: 9781952457722 -> 9781250268396 (score: 0.330000)
Adding similarity: 9781952457722 -> 9781250268426 (score: 0.330000)
Adding similarity: 9781952457722 -> 9781250851208 (score: 0.330000)
Adding similarity: 9781952457722 -> 9781398529489 (score: 0.330000)
Adding similarity: 9781952457722 -> 9781665955430 (score: 0.330000)
Executing query: 
            SELECT b.ISBN, b.Title, b.Description, b.Series_ID,
                   GROUP_CONCAT(DISTINCT c.Name) AS Categories,
                   GROUP_CONCAT(DISTINCT t.Tag_Name) AS Tags,
                   GROUP_CONCAT(DISTINCT a.Name) AS Authors
            FROM book b
            LEFT JOIN belongs bc ON b.ISBN = bc.ISBN
            LEFT JOIN category c ON bc.Category_ID = c.Category_ID
            LEFT JOIN book_tags bt ON b.ISBN = bt.ISBN
            LEFT JOIN tags t ON bt.Tag_ID = t.Tag_ID
            LEFT JOIN wrote w ON b.ISBN = w.ISBN
            LEFT JOIN author a ON w.Author_ID = a.Author_ID
            LEFT JOIN (
                SELECT ISBN_1, COUNT(*) AS sim_count
                FROM book_similarity
                GROUP BY ISBN_1
            ) bs ON b.ISBN = bs.ISBN_1
            WHERE bs.sim_count IS NULL OR bs.sim_count < 10
            GROUP BY b.ISBN
            LIMIT 100 OFFSET 100
        
Retrieved 1 books in this batch
Processing book: Ruin and Rising (ISBN: None)
Executing similarity query for ISBN: None
Found 10 similar books
Adding similarity: None -> 9781250044433 (score: 1.000000)
Adding similarity: None -> 9780805094596 (score: 0.940000)
Adding similarity: None -> 9781250142276 (score: 0.900000)
Adding similarity: None -> 9781250076977 (score: 0.840000)
Adding similarity: None -> 9781250624642 (score: 0.780000)
Adding similarity: None -> 9781627792127 (score: 0.780000)
Adding similarity: None -> 9781466820753 (score: 0.630000)
Adding similarity: None -> 9781250095251 (score: 0.540000)
Adding similarity: None -> 9781250095312 (score: 0.540000)
Adding similarity: None -> 9781250268396 (score: 0.390000)
Executing query: 
            SELECT b.ISBN, b.Title, b.Description, b.Series_ID,
                   GROUP_CONCAT(DISTINCT c.Name) AS Categories,
                   GROUP_CONCAT(DISTINCT t.Tag_Name) AS Tags,
                   GROUP_CONCAT(DISTINCT a.Name) AS Authors
            FROM book b
            LEFT JOIN belongs bc ON b.ISBN = bc.ISBN
            LEFT JOIN category c ON bc.Category_ID = c.Category_ID
            LEFT JOIN book_tags bt ON b.ISBN = bt.ISBN
            LEFT JOIN tags t ON bt.Tag_ID = t.Tag_ID
            LEFT JOIN wrote w ON b.ISBN = w.ISBN
            LEFT JOIN author a ON w.Author_ID = a.Author_ID
            LEFT JOIN (
                SELECT ISBN_1, COUNT(*) AS sim_count
                FROM book_similarity
                GROUP BY ISBN_1
            ) bs ON b.ISBN = bs.ISBN_1
            WHERE bs.sim_count IS NULL OR bs.sim_count < 10
            GROUP BY b.ISBN
            LIMIT 100 OFFSET 200
        
Retrieved 0 books in this batch
Finished processing. Total books processed: 101, Total similarities added: 267
2025-05-23 19:18:05,688 - INFO - Starting similarity calculation
2025-05-23 19:18:05,813 - INFO - Database connection established
2025-05-23 19:18:05,908 - INFO - Retrieved 250 books
2025-05-23 19:18:06,018 - INFO - Processing batch 1 of 3
2025-05-23 19:18:06,269 - INFO - Processing batch 2 of 3
2025-05-23 19:18:06,379 - INFO - Processing batch 3 of 3
2025-05-23 19:18:06,395 - INFO - Calculated 2112 similarity pairs
2025-05-23 19:18:06,708 - INFO - Stored batch 1 of 3
2025-05-23 19:18:06,818 - INFO - Stored batch 2 of 3
2025-05-23 19:18:06,833 - INFO - Stored batch 3 of 3
2025-05-23 19:18:06,833 - INFO - Similarities stored in database
2025-05-23 19:18:06,833 - INFO - Process completed in 1.15 seconds
2025-05-23 19:21:19,704 - INFO - Starting similarity calculation
2025-05-23 19:21:19,786 - INFO - Database connection established
2025-05-23 19:21:19,818 - INFO - Retrieved 250 books
2025-05-23 19:21:19,905 - INFO - Processing batch 1 of 3
2025-05-23 19:21:20,085 - INFO - Processing batch 2 of 3
2025-05-23 19:21:20,195 - INFO - Processing batch 3 of 3
2025-05-23 19:21:20,211 - INFO - Calculated 2112 similarity pairs
2025-05-23 19:21:20,447 - INFO - Stored batch 1 of 3
2025-05-23 19:21:20,541 - INFO - Stored batch 2 of 3
2025-05-23 19:21:20,541 - INFO - Stored batch 3 of 3
2025-05-23 19:21:20,541 - INFO - Similarities stored in database
2025-05-23 19:21:20,556 - INFO - Process completed in 0.85 seconds
